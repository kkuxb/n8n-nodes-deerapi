# n8n-nodes-DeerAPI（V1.3.0版本）

🚀 **告别见鬼的 HTTP Request 节点！** 在 n8n 中像原生节点一样傻瓜式调用 DeerAPI中的模型。

---

## 🌟 为什么开发这个节点？

还在为配置那个该死的 **HTTP Request** 节点抓耳挠腮吗？还在手动拼接复杂的 JSON 或者在 Code 节点里苦哈哈地写 Base64 转换函数吗？（说的就是我自己）

由于官方（DeerAPI）目前只做了 Dify 的节点，完全忽视了我们 n8n 用户的感受。因此，本项目诞生了！

作者本人**完全没有代码基础**，全靠 **Gemini-3-pro** 鼎力赞助完成，但它确实能用，而且（对我来说）很好用！

## ✨ 核心亮点

- **傻瓜式配置**：摆脱复杂的 API 参数构造，配置简单选项即可开用。

- **自动图像处理**：彻底解决 Base64 转换痛点。直接读取 `Binary` 选项卡中的图片，生成结果也直接返回图片。

- **三模式支持**：同时支持“文字生成”、“图片生成”、“视频生成”三种模式。

---

## 🛠️ 功能详解

### 1. 文字生成模式

- **模型自定义**：支持手动指定模型 ID（例如 `gemini-3-flash` 等）。

- **双模态支持**：支持发送 **文字 + 图片** 的组合。

- **自动 Base64**：节点会自动识别并转换 Binary 中的图片文件，**最高支持 3 张图片同时输入**。再也不用手动加代码节点去做转换了！

- **文档附件：** 配合Extract from File节点使用。Extract from File节点会提取pdf等文件中的文字内容，以text字段输出，本节点则会自动抓取上一节点输出的text字段内容，并自动与用户提示词进行拼接，实现将提示词+文档内容一并传输给AI。

### 2. 图片生成模式

- **极简输入输出**：输入是 Binary 图片，输出也是 Binary 图片，节点内自动完成图片转base64、单图与多图处理逻辑切换、base64转图片。

- **多样化创作**：
  
  - **文生图**：输入 Prompt 直接生成。
  
  - **图生图**：支持“文 + 单图”或“文 + 多图”生图（参考图上限为 3 张）。

- **简单参数**：下拉框选择设置 **分辨率** 、 **尺寸比例** 、 **生成张数** 。

- **生图模型**：当前支持 `gemini-3-pro-image` 与 `即梦4.5` 两个模型。

### 3. 视频生成模式 (Sora 2)

这是1.3.0 版本更新的功能。基本完美适配了 Sora 2 的异步生成链路：

- **五大核心操作**：
  
  - **创建视频**：支持 `Sora 2` 与 `Sora 2 Pro`。
  
  - **混编视频**：基于已有视频 ID 进行二次创作。
  
  - **检索视频**：获取生成进度与状态。
  
  - **下载视频**：获取最终的 MP4 二进制文件。
  
  - **历史列表**：查询历史视频任务。

- **故事板模式：** 
  
  开启后，你可以分镜头（Shot 1, Shot 2...）填写内容。节点会自动帮你组合成复杂的、符合 API 要求的格式，实现分镜级的视频控制！

- **智能轮询等待：**
  
  检索视频时，节点会自动每 15 秒查一次生成进度，最长持续查询 10 分钟。查询到视频生成完毕后，节点才运行成功。

---

## 📦 安装方法

在你的 n8n 根目录下运行：

```
npm install n8n-nodes-deerapi
```

或者在 n8n 设定页面的 **Community Nodes** 中搜索 `n8n-nodes-DeerAPI` 进行安装。

（个人推荐下面这种方法，因为安装方法是Gemini自己脑补写的，虽然看起来是对的，但我没用过命令行安装的方式）

---

## 🛞 使用流程

1. **添加凭证：** 在n8n凭证管理页面创建凭证，凭证搜索"DeerAPI"。凭证只需要填入从DeerAPI后台获取的API Key就行了，**Base URL不要改** 。

2. **添加节点：** 在工作流中添加节点时，可搜索“DeerAPI"，即可找到本节点（找不到是因为你还没安装本社区节点）

3. **节点配置：** 选择凭证 → 选择模式（文本生成/图像生成/视频生成）→ 填好其它两三个参数（模型ID、提示词等）→ OJ8K完事！

> **说明：** “图片属性名”这个参数，默认填写了data, data0, data1, data2, file, attachment，这个其实可以不用改，节点会自动检测这几个属性名中哪些是有图片的哪些没图片，这就避免了每次传图还得手动去配置图片的属性名。因为n8n工作流 Binary 选项卡中的图片属性名一般默认就是data, data0之类的。当然，如果你的图片的属性名不一样，这里就需要你自己填了。

---

## ⚠️ 免责声明 & 致谢

1. **关于代码**：本项目所有核心代码均由 **Gemini-3-pro** 编写。作者本人不保证代码的完美性，如有 Bug 纯属正常（毕竟是 AI 写的）。

2. **功能限制**：目前功能相对有限，大家凑合用吧。如果你是大佬，欢迎提交 PR 进行迭代。或者也可以联系我讨论一些迭代思路。

3. **开发者寄语**：寄语个G8，让Gemini写个README文档，叽叽歪歪净扯没用的。

4. **顺便交点朋友：** 本人专注于研究电商领域的AI技术应用，电商干了13年，AI的话练习时长两年半。微信号：maosonghuai

---

**如果你觉得这个项目帮到了你，请给个 Star 🌟，这也是对 Gemini 最大的鼓励！**

（反之，如果你觉得没帮到，请骂Gemini）
